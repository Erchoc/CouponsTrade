
[TOC]:#

# Table of Contents
- [用例图](#用例图)
- [术语](#术语)
- [用户功能](#用户功能)
    - [注册](#注册)
    - [登录](#登录)
    - [找回密码](#找回密码)
    - [查看个人信息功能](#查看个人信息功能)
    - [编辑用户信息功能](#编辑用户信息功能)
    - [生成邀请码](#生成邀请码)
    - [电子钱包充值功能](#电子钱包充值功能)
    - [电子钱包提现功能](#电子钱包提现功能)
- [发售功能](#发售功能)
    - [发布优惠券](#发布优惠券)
    - [发布求购信息](#发布求购信息)
    - [求购优惠券信息](#求购优惠券信息)
    - [下架优惠券](#下架优惠券)
    - [自动下架](#自动下架)
    - [编辑优惠券](#编辑优惠券)
    - [查看发布的优惠券](#查看发布的优惠券)
    - [**处理退货**](#处理退货)
- [购买功能](#购买功能)
    - [查询优惠券列表](#查询优惠券列表)
    - [查看优惠券详情](#查看优惠券详情)
    - [支付](#支付)
    - [查看购买的优惠券](#查看购买的优惠券)
    - [贩卖优惠券](#贩卖优惠券)
    - [申请退货](#申请退货)
    - [申请仲裁](#申请仲裁)
    - [仲裁室](#仲裁室)
    - [仲裁](#仲裁)
- [社交功能](#社交功能)
    - [添加好友](#添加好友)
    - [好友列表](#好友列表)
    - [删除好友](#删除好友)
    - [即时通讯](#即时通讯)
- [其他功能](#其他功能)
    - [平台清算](#平台清算)
    - [消息通知](#消息通知)

## 用例图
![用例图](/doc/map/coupon-trand-use-case-1.png)
![用例图](/doc/map/coupon-trand-use-case-2.png)

## 术语

- 平台：`优惠券`交易`平台`
- 优惠券：可电子化（数字化）、有效的电子优惠券
- 潜在用户
  - 满足以下条件的自然人
  - 条件
    - 有通过本`平台`进行`优惠券`买卖意愿
    - 有微信并且可以微信支付
    - 有手机号并且手机号没有在本`平台`注册
    - 有获取邀请码的渠道
- 用户：已在`平台`注册的自然人，是系统的直接参与者。
- 邀请码：潜在`用户`在注册时需要的凭证
- 买家：
  - 在`卖场`购买`卖家`出售的`优惠券`的`用户`，
  - 或在`卖场`发布求购`优惠券`信息等待`卖家`出售`电子优惠券`的`用户`
- 卖家：
  - 在`卖场`出售`买家`需要的`优惠券`的`用户`，
  - 或在`卖场`发布出售`优惠券`信息等待`买家`购买`电子优惠券`的`用户`
- 卖场：
  - `卖家`可以在此发布和管理出售的`优惠券`。
  - `买家`可以在此浏览和购买`优惠券`。
- 买场：
  - `买家`可以在此发布和管理求购的`优惠券`。
  - `卖家`可以在此浏览和出售`优惠券`。
- 好友：`用户`与`用户`之间建立的联系
- 仲裁：买卖双方存在争议`订单`，由买卖双方陈述原由，由`仲裁参与者`投票来判断对错
- 仲裁参与者：买卖双方的非直接关系`好友`
- 订单：`平台`根据`优惠券`生成的双方契约
- 截止日期：`优惠券`的最晚有效日期
- 优惠券状态：未发布、发布、已售、下架
- 订单状态：已支付、已退货、申请退货、拒绝退货、`仲裁`开启、`仲裁`结束
- 优惠券类别：西餐、海鲜、咖啡、面包糕点、火锅、烧烤、冰激凌、快餐、自助餐、其他
- 限：是指是否限制，含义是优惠券的使用日期是否受限制
- 退：是否支持退货


## 用户功能

### 注册
- 功能描述：使潜在用户成为用户的功能，注册成功后邀请人与被邀请人成为好友关系
- 一期已完成功能说明：
  - 注册功能，其中注册信息包括昵称、手机号、模拟手机验证码、密码、`邀请码`
  - 注册失败提示信息未：手机验证码或邀请码错误
- 二期需要完成的内容：
  - `潜在用户`在注册页面输入注册信息中，在输入手机号后，添加虚拟手机号的验证,添加向手机发送验证码的功能
  - `潜在用户`在注册页面输入注册信息中，手机验证码由模拟值变为真实值
  - `潜在用户`在注册页面输入注册信息中，`邀请码`要有`邀请码`的超时验证，超时时间半小时。
  - `潜在用户`可以选择是否绑定微信号
  - `潜在用户`注册成功后，邀请人与被邀请人成为`好友`关系
  - 后台保存`用户`的注册日期
  - 后台生成`用户`ID，标识唯一`用户`的ID
  - 用户头像

### 登录
- 功能描述：`平台`验证`用户`的真实性
- 一期完成功能
  - `用户`的登录功能已完成，用户登陆成功则进入平台。
  - `用户`登陆失败则提示账号或密码错误。
- 二期需要添加功能
  - `用户`登录成功后，定位用户的坐标，当用户在查询附近`优惠券`时用。
  - 将登陆错误提示信息：账号修改为用户名

### 找回密码
- 功能描述：当用户忘记密码时，提供一个找回密码的功能
- 可以通过输入手机号，发送手机架验证码的方式来进行验证。

### 查看个人信息功能
- 功能描述：`用户`查看自己的信息的功能，包括:昵称、手机号、注册日期、购买量、卖出量、争议量、邀请关系
- 一期已完成功能说明：
  - 查看个人信息功能，查看信息要素包括：昵称、手机号、`邀请码`
- 二期需求在`查看个人信息功能`中
  - 需要去掉查看要素
    - `邀请码`：因为邀请码的生命周期包括已使用和超时，在查看个人信息时，邀请码的生命周期已结束
  - 需要修改的要素
    - `手机号`：修改为遮掩显示，将除前三位和后四位之外的号码用*号代替
  - 需添加的查看要素：
    - `用户`注册日期
    - `用户`购买量
    - `用户`卖出量
    - `用户`争议量：包括退货、仲裁
    - `用户`邀请关系网：展示与`用户`有直接邀请关系的`用户`昵称（包括你邀请的那些人和谁邀请的你）

### 编辑用户信息功能
- 功能描述：修改用户信息的功能
- 一期已完成功能
  - 可以编辑的`用户`信息要素包括：昵称、手机号、`邀请码`
  - 未实现编辑功能
- 二期需要完成功能，调整编辑功能
  - 手机号要修改为不是`用户`的ID
  - 如果要修改手机号，则需要重新发送手机验证码，添加发送手机验证码的功能
  - 去掉编辑要素`邀请码`
  - 实现编辑`用户`信息的编辑功能


### 生成邀请码
- 功能描述：用来提供给被邀请的`用户`注册信息时用的信息。
- 一期已完成功能：
  - 后台固定生成了一个`邀请码`
- 二期需要完成需求
  - 生成`邀请码`的次数和邀请人数不受限制。
  - 实现生成`邀请码`的功能

### 电子钱包充值功能
- 功能描述：电子钱包用于`平台`给用户清算、`用户`交易时走账、查看收支记录
- 一期未开发该功能
- 二期需要完成的内容：电子钱包充值功能
  - 电子钱包充值功能的前置条件：
    - `用户`已登陆`平台`
  - 电子钱包充值功能的操作步骤如下：
    - `用户`进入个人电子钱包
    - `用户`点击`充值`
    - `用户`选择充值方式：微信
    - `用户`录入充值金额
    - `用户`点击确认充值

### 电子钱包提现功能
- 功能描述：电子钱包用于`平台`给用户清算、`用户`交易时走账、查看收支记录
- 一期未开发该功能
- 二期需要完成的内容：电子钱包提现功能
  - 电子钱包提现功能的前置条件：
    - `用户`已登陆`平台`
  - 电子钱包提现功能的操作步骤如下：
    - `用户`进入个人电子钱包
    - `用户`点击`提现`
    - `平台`判断`用户`是否已关注平台微信公众号：
      - 如果已关注，则直接通过微信进行提现；
      - 如果未关注，则`用户`需要关注平台微信公众号
    - `用户`选择提现方式：微信
    - `用户`录入提现金额
    - `用户`点击确认提现

## 发售功能

### 发布优惠券
- 功能描述：`用户`在`平台`发布`优惠券`信息，进行售卖的功能
- 一期已完成功能：
  - 发布`优惠券`的功能中，录入的`优惠券`信息：`优惠券`名称、`优惠券`码、原价、售卖价、券面价、截止日期、是否支持退货、描述
- 二期需求需要完成内容
  - 发布`优惠券`中，在一期基础上，添加录入`优惠券`信息要素添加：
    - 适用区域信息（分级别（一级：全国；二级：省（市），如北京；三级：区（市），如：海淀区））
    - 券码形式：券码形式的选择与`优惠券`码是联动的。券码图片在上传过程中转化为文本进行存储
    - `优惠券`码：添加`优惠券`码的图片上传功能
    - 门店的信息：（输入商户名称，通过地图采集门店坐标、名称、地址、电话）
    - `优惠券`相关图片：（如果不上传图片，则使用平台默认图片，图片最多上传6张，且图片要求第一张是必须与`优惠券`相关，但不能是`优惠券`券码图片）
    - 是否限制：优惠券的使用日期是否受限制，添加提示信息：具体限制内容请查看优惠券描述信息
  - 发布`优惠券`中，需要去掉的内容
    - 去掉`优惠券`券码文本的唯一性验证：目前项目做了文本的唯一性验证，无法保证验证码图片的唯一性，因此去掉优惠券码唯一性验证
  - 发布`优惠券`中，需要修改的内容
    - 自动退货改为是否支持退货
  - 实现发布`优惠券`的发布功能。

### 发布求购信息
- 功能描述：`买家`在`平台`发布`求购优惠券`信息，发布完成后，并进行支付的的功能。
- 一期未完成该功能
- 二期需求需要完成该功能
  - `买家`在`平台`发布`求购优惠券`信息
  - `买家`提前支付相应金额给平台
  - `卖家`查看求购`优惠券`信息，填写`优惠券`信息，将券卖出，`平台`给`卖家`转账的功能。
  - 求购优惠券信息要素：
    - 标题（必输项）
    - 券类别：代金券、折扣券、其他
    - 买价（必输项）
    - 适用区域（必输项）
    - 店位置(待定)
    - 使用日期区间：（必输项）
    - 下架日期：（必输项）
    - 描述：卖家想补充的其他要素信息，卖家想补充的其他要素信息比如券面价，是否有使用限制日期信息
  - `卖家`填写的信息包括：
    - 优惠券券码
  - `买家`在`买场`发布`求购优惠券`信息
  - `卖家`在`买场`查看`买家`发布的`求购优惠券`信息


### 求购优惠券信息
- 一期未完成该功能
- 二期需要完成的功能如下：
  维护求购优惠券信息包括查看求购优惠券信息列表、查看求购优惠券信息详情、查看求购优惠券

#### 查看求购优惠券信息列表
- 列表内容展示要素包括：标题、券类别（代金券、折扣券、其他）、买价

#### 查看求购优惠券信息详情
- 详情展示内容包括：标题、券类别（代金券、折扣券、其他）、买价、适用区域、店位置、使用日期区间、下架日期、描述

#### 编辑求购的优惠券信息
- 可编辑的要素包括：买价、使用日期区间、下架日期、描述

#### 下架求购的优惠券信息
- 描述：提供下架求购的优惠券信息的功能。

### 下架优惠券
- 功能描述：将优惠券手动下架的功能
- 一期已完成下架`优惠券`功能。
- 二期不用再完成该功能

### 自动下架
- 功能描述：是指当`平台`的日期大于`优惠券`的截止日期时，平台下架`优惠券`，使`优惠券`不再售卖的功能
- 一期未完成该功能
- 二期需要完成的功能:`优惠券`的自动下架功能
  - 当`平台`日期超过`优惠券`的`截止日期`时，`平台`将`优惠券`自动下架

### 编辑优惠券
- 功能描述：`用户`在`平台`编辑`优惠券`信息
- 一期已完成功能：
  - 发布`优惠券`的功能中，编辑`优惠券`信息包括：`优惠券`名称、`优惠券`码、原价、售卖价、券面价、截止日期、是否支持退货、描述
- 二期需求需要完成内容
  - 编辑`优惠券`中，编辑`优惠券`信息添加如下要素：
    - 适用区域信息分级别（一级：全国；二级：省（市），如北京；三级：区（市），如：海淀区）
    - 券码形式：券码形式的选择与`优惠券`码是联动的。当券码形式为图片，则`优惠券`码为图片上传功能；当券码形式为文本，则`优惠券`码为输入文本的功能
    - `优惠券`码：添加`优惠券`码的图片上传功能
    - 门店的信息（输入商户名称，通过地图采集门店坐标、名称、地址、电话）
    - `优惠券`相关图片（`优惠券`相关图片必须上传一张图片，最多上传6张，且图片要求第一张是必须与`优惠券`相关，但不能是`优惠券`券码图片）
    - 是否限制:优惠券的使用日期是否受限制
  - 编辑`优惠券`中，编辑`优惠券`信息修改如下要素：
    - 自动退货改为是否支持退货
  - 编辑`优惠券`中，实现编辑功能

### 查看发布的优惠券
- 功能描述：“查看发布的优惠券”包括“查看售卖中的优惠券”、“查看下架的优惠券”、“查看卖出的优惠券”三个小功能
- 一期只实现了查看已发布的优惠券功能
- 二期需要实现
  - 将“查看售卖中的优惠券”、“查看下架的优惠券”、“查看卖出的优惠券”三个小功能放在“查看发布的优惠券”功能中

#### 查看售卖中的优惠券
- 功能描述：查看`用户`已发布的`优惠券`信息
- 一期已完成功能：
  - 查看已发布`优惠券`列表
    - 查看的要素信息包括：`优惠券`名称、售卖价、`优惠券`描述
  - 查看已发布`优惠券`详情
    - 查看的要素信息包括：`用户`昵称、`优惠券`名称、原价、售卖价、是否支持退货、`优惠券类别`、`优惠券状态`、截止日期、`优惠券`描述
- 二期需要完成功能：
  - 查看已发布`优惠券`列表，查看的要素信息添加：券面价
  - 查看已发布`优惠券`详情，查看的要素信息添加：
    - 适用区域信息(分级别（一级：全国；二级：省（市），如北京；三级：区（市），如：海淀区）)
    - 券码形式：是指上传的`优惠券`的券码是文本形式还是图片形式，两个选项
    - 券面价、
    - 门店的信息（门店的名称、地址、电话）
    - `优惠券`相关图片（如果不上传图片，则使用平台默认图片，图片最多上传6张，且图片要求第一张是必须与`优惠券`相关，但不能是`优惠券`券码图片）
    - 是否限制
  - 查看已发布`优惠券`详情，查看的要素信息去掉：
    - 用户昵称
  - 查看已发布`优惠券`详情，要修改的要素：
    - 可自动退货修改为是否支持退货

#### 查看下架的优惠券
- 功能描述：查看`用户`已下架的`优惠券`信息
- 一期未实现该功能
- 二期需要完成功能，添加下架的`优惠券`功能
  - 查看已下架的`优惠券`列表
    - 查看的要素信息包括：`优惠券`名称、售卖价、券面价、`优惠券`描述
  - 查看已下架的`优惠券`详情
    - 查看的要素信息包括：`优惠券`名称、原价、售卖价、券面价、是否支持退货、是否限制、`优惠券类别`、`优惠券状态`、`截止日期`、`优惠券`描述

#### 查看卖出的优惠券
- 功能描述：`卖家`查看卖出的优惠券的功能
- 一期未实现该功能
- 二期需要完成的功能,添加卖出的优惠券的功能，包括已结算订单
  - 查看卖出的`优惠券`列表
    - `订单状态`包括已支付、已退货、申请退货、拒绝退货、`仲裁`开启、`仲裁`结束。后台会有取消订单的状态
    - 页面要素包括：`优惠券`名称、售卖价、券面价、`优惠券`描述
  - 查看卖出的`优惠券`详情
    - 页面要素包括：`优惠券`名称、原价、售卖价、券面价、是否支持退货、是否限制、`优惠券类别`、`优惠券状态`、截止日期、`优惠券`描述、买家昵称、卖家昵称、订单编号、成交时间


### **处理退货**
- 功能描述：`卖家`同意或者拒绝`买家`的退货
- 一期未实现该功能
- 二期需要完成的需求：`卖家`处理退货的功能
  - 处理退货的条件：
    - `买家`申请退货
    - `卖家`收到`平台`发的申请退货信息
    - 退货时间是3天，卖家无响应，则先查看卖家电子钱包的余额
      - 余额为正且大于等于退款金额，那么就直接退款给买家
      - 余额小于退款金额或者余额为负，则提示给买家：卖家已同意退货，请等待卖家退款。

## 购买功能

### 查询优惠券列表
- 功能描述：`用户`通过输入`优惠券`名称、附近、`优惠券`分类、区域、排序查询`优惠券`，快速查找到目标`优惠券`
- 一期已完成功能
  - `用户`输入`优惠券`名称，模糊查询到`优惠券`的列表
  - 查询的要素信息包括：`优惠券`名称、售卖价、`优惠券`描述
- 二期需要完成功能
  - 添加新的查询条件：通过附近、`优惠券`分类、适用区域、排序查询`优惠券`
     - 附近：通过百度地图采集的门店的坐标信息，以`用户`坐标为中心，按照用户和门店之间的距离由近到远进行排序
     - 优惠券分类：包括西餐、海鲜、咖啡、面包糕点、火锅、烧烤、冰激凌、快餐、自助餐、其他
     - 适用区域：分级别（一级：全国；二级：省（市），如北京；三级：区（市），如：海淀区）
     - 排序：售卖价（由低到高）、距离（由近到远）
  - 添加优惠券列表展示要素信息
    - 适用区域：（分级别（一级：全国；二级：省（市），如北京；三级：区（市），如：海淀区））
    - 退：是否支持退款
    - 限：使用日期是否受限制，如：使用日期仅限于周三使用


### 查看优惠券详情
- 功能描述：`用户`在查找到目标`优惠券`后，通过查看`优惠券`详情功能，查看`优惠券`的详细信息。
  - 注：详细信息中添加`用户`注册日期、购买量、卖出量、争议量、买卖双方的邀请关系链（展示用户昵称），帮助用户判断购买`优惠券`的风险
- 一期已完成功能：
  - 查看`优惠券`详情，查看的要素信息包括：
    - `用户`昵称、`优惠券`名称、原价、售卖价、是否支持自动退货、`优惠券类别`、`优惠券状态`、截止日期、`优惠券`描述
- 二期需要完成功能：
  - 查看`优惠券`详情功能，添加要查看的要素信息：
    - 适用区域信息（分级别（一级：全国；二级：省（市），如北京；三级：区（市），如：海淀区））
    - 券码形式
    - 券面价、
    - 门店的信息（门店的名称、地址、电话），具体怎么展示（待定）
    - `优惠券`相关图片（如果不上传图片，则使用平台默认图片，图片最多上传6张，且图片要求第一张是必须与`优惠券`相关，但不能是`优惠券`券码图片）
    - `用户`注册日期
    - `用户`购买量
    - `用户`卖出量
    - `用户`争议量：包括退货、仲裁
    - 买卖双方的邀请关系网：展示与`用户`有邀请关系的`用户`昵称（包括你邀请的那些人和谁邀请的你）
  - 修改按钮：
    - “我要买”按钮修改为“支付”按钮
  - 添加联系卖家即时通讯功能

### 支付
- 功能描述：用户对选择的优惠券进行支付的功能，谁先支付则优惠券属于谁
- 一期已完成功能
  - 通过微信和支付宝两种支付渠道进行模拟支付功能
  - 页面要素：`卖家`昵称、`卖家`手机号、模拟支付渠道(微信、支付宝)、优惠券名称、优惠券售卖价、留言
- 二期需要完成功能
  - 修改功能
    - 用户点击支付按钮，直接进入支付页面进行支付。
    - 去掉待支付订单、取消订单、订单超时的功能，对于优惠券，谁先支付，则优惠券卖给谁。
  - 添加功能
    - 选择支付方式添加余额支付方式
    - 模拟支付修改为真实支付，包括微信、余额

### 查看购买的优惠券
- 功能描述：`买家`通过“查看购买的优惠券”的功能，查看购买了哪些优惠券
- 一期已完成功能
  - 查看购买的优惠券列表
  - 查看购买的优惠券详情
- 二期需要完成功能
  - 查看购买的优惠券列表中
     - `订单状态`包括已支付、已退货、申请退货、拒绝退货、`仲裁`开启、`仲裁`结束。后台会有取消订单的状态
  - 查看购买的优惠券详情
    - `优惠券`名称、原价、售卖价、券面价、是否支持退货、是否限制、`优惠券类别`、`优惠券状态`、截止日期、`优惠券`描述、买家昵称、卖家昵称、订单编号、成交时间


### 贩卖优惠券
- 功能描述：为了让优惠券在`平台`进行流动，在`买家`购买优惠券未到`截止日期`的前提下，`卖家`可以继续发布该优惠券，`买家`可以在平台继续卖购买的优惠券。
- 一期未实现该功能
- 二期需要完成功能
  - 贩卖优惠券的前提：用户已完成优惠券的支付步骤：
    - `用户`在购买的优惠券详情页面，操作继续售卖功能
    - `平台`后台采集购买的优惠券的信息，页面展示这些信息，并且可编辑（优惠券券码除外）
    - 点击`发布`按钮，将优惠券再次发布

### 申请退货
- 功能描述：`用户`对已购买的`优惠券`不满或无法消费时，要进行退货的功能
- 一期未实现该功能
- 二期需要完成功能
  - 申请退货的功能，`买家`在已购买优惠券的详情中进行操作

### 申请仲裁
- 功能描述：当`卖家`拒绝`买家`的退货申请时，`买家`可以在`平台`申请`仲裁`
- 一期未实现该功能
- 二期需要完成该功能

### 仲裁室
- 功能描述：`卖家`与`买家`在仲裁过程中陈述事件的地方
- 一期未实现该功能
- 二期需要实现该功能
- 步骤：
  - 当`用户`申请仲裁，仲裁的相关人员就会进入仲裁室
  - 买卖双方在聊天室陈述事件的原由
  - 其他的仲裁相关人员在仲裁室可以看到买卖双方的陈述内容，并且在此进行投票

### 仲裁
- 功能描述`用户`申请仲裁后，买卖双方在仲裁室陈述事件，仲裁参与者可以看到买卖双方的陈述内容，然后进行投票，在第一轮投票结束后如果无人投票或者平票，则拉入更多的仲裁参与人员继续下一轮投票，直到有结果为止。
- 一期未实现该功能
- 二期需要实现该功能

## 社交功能

### 添加好友
- 功能描述：为了提高`用户`之间的粘性，用户可以添加其他`用户`为`好友`
- 一期未实现该功能
- 二期需要完成功能
  - 添加`好友`的功能，
    - 在优惠券详情中提供该添加好友功能
    - 在即时通讯工具中提供添加好友功能
  - 在添加`好友`时，需要对方进行同意才能添加为`好友`

### 好友列表
- 功能描述：为了方便`用户`查看`好友`的信息，`用户`可以查看`好友`的信息，包括`好友`列表和`好友`在卖的优惠券信息
- 一期未实现该功能
- 二期需要完成功能
  - 查看`好友`信息的功能
    - 可以查看`好友`的昵称
    - 通过点击`好友`列表中的`好友`昵称，可以查看`好友`的明细：显示`好友`正在售卖的`优惠券`列表

### 删除好友
- 功能描述：当`好友`之间关系不在友好时，`用户`可以解除`好友`关系，通过删除功能来实现。
- 一期未实现该功能
 - 二期需要完成功能
   - 删除`好友`功能
     - 在用户删除`好友`时，对方的`好友`列表中也会删除对方。


### 即时通讯
- 功能描述：`用户`之间进行沟通的工具
- 一期未实现该功能
- 二期需要实现该功能


## 其他功能

### 平台清算
- 功能描述：`平台`采用实时清算。
- 一期未实现该功能
- 二期需要实现该功能

### 消息通知
- `平台`推送消息给`用户`
- 一期未实现该功能
- 二期需要实现该功能


